# Domain Name System
*tags:* #net #server #linux
*description:* Система доменных имен, которая обеспечивает связь между наименованием сайта и его цифровым адресом. Таблица с соответствиями имен и ip адресам обычно находиться в файле /etc/hosts. Система состоит из иерархической структуры DNS-серверов, каждый из которых является держателем одной или нескольких доменных зон и отвечает на запросы этих зон, а также DNS-резо́лверов, которые отвечают на запросы, касающиеся любых зон. Функции держателя зоны и резолвера часто совмещаются в одной программе; например, таковой является популярный DNS-сервер [[$- BIND]].
*link:* https://timeweb.com/ru/community/articles/chto-takoe-dns-prostymi-slovami

---

## Домены

==Доменное имя== - символьное имя, за которым прячется числовой ip-адрес ([[$ Web base]]). Обычно домен - это группа логически объединенных поддоменов (mail`.google.com`, docs`.google.com`, plus`.google.com`). Здесь `.com` - домен верхнего (первого) уровня. Вы можете зарегистрировать домен второго уровня (`yashno`.tv, `google`.com). Затем системный администратор создает поддомены 3 уровня под нужды сайта.
```
www.leningrad.spd.ru:
ru - 1 уровень
spb - 2 уровень
и т.д.
```

==Доменная зона== - совокупность доменных имен определенного уровня, входящих в конкретный домен. Например, зона wikipedia.org включает все доменные имена третьего уровня в этом домене. Это любая часть дерева системы доменных имен, размещаемая как единое целое на некотором DNS-сервере. Зону, для бОльшего понимания, можно назвать «зоной ответственности». Целью выделения части дерева в отдельную зону является передача ответственности (==Делегирование==) за эту ветвь другому лицу или организации. 

Если пользователь собирается посетить сайт, находящийся в другой стране, то регулярная передача запросов к первичному серверу занимает много времени и приводит к медленной загрузке страниц. Чтобы избежать подобных неудобств, DNS-сервер, находящийся рядом с вашим устройством, **кэширует** данные о запрашиваемых ранее IP-адресах и выдает их при следующем обращении.

Источниками хранения ресурсных записей являются исходные DNS-серверы, содержащие начальные связи между доменами и сетевыми адресами узлов.

Для обеспечения уникальности и защиты прав владельцев доменные имена 1-го и 2-го (в отдельных случаях и 3-го) уровней можно использовать только после их регистрации, которая производится уполномоченными на то [регистраторами](https://ru.wikipedia.org/wiki/Регистратор_доменных_имён). Сведения о владельце (администраторе) того или иного регистрируемого домена общедоступны. Их можно узнать, воспользовавшись службой whois. 

## Этапы поиска информации
1. Браузер получает запрос от пользователя и направляет его DNS-серверу сети, который ищет совпадение доменного имени и сетевого адреса. Если ответ обнаружен, то страница сайта загружается сразу. В противном случае запрос будет отправлен серверу более высокого уровня или корневому.
2. Корневой сервер направляет запрос серверу первого уровня, который в свою очередь передает его серверу второго уровня. Это движение продолжается до тех пор, пока не будет найдено совпадение имени и IP-адреса.
3. Браузер получает ответ на свой запрос, направляет его к хостингу, и страница открывается.

## Виды DNS-серверов
Для размещения DNS-серверов существует несколько вариантов:

- ДНС-серверы хостинг-провайдера
- Собственные ДНС-серверы
- Бесплатные DNS-хостинги
- Платные DNS-хостинги
- CDN-прокси (в режиме DNS)

### Собственный DNS-сервер
Настроить серверы имён можно и без панели управления. Для этого достаточно установить программу DNS-сервера (например, ==BIND==) и создать конфигурационный файл по образцу.

*Если вы пользуетесь услугами защиты от DDoS, размещать DNS-сервис и сайт на одном сервере не рекомендуется. Cервисы защиты от DDoS могут блокировать весь UDP-трафик в случае сильных атак, и клиенты не могут получить доступ к серверу имен — сайт будет недоступен по доменному имени. В этом случае DNS следует располагать на отдельном сервере.*

**Плюсы:**
- Независимость от сторонних ресурсов
- Возможность настройки DNS под себя и использование собственных скриптов
- Бесплатно

**Минусы:**
- Требуется 2 ip-адреса
- Сложность насторйки
- Самостоятельная поддержка работоспособности
- Возможны проблемы в случае использования DDoS-защиты.

Регистраторы требуют, чтобы для каждого домена было минимум два сервера имён: первичный (master) и как минимум один вторичный (slave). В качестве адресов должны быть указаны два разных IP-адреса. Чтобы удовлетворить это требование, к серверу подключают дополнительный IP-адрес. Основный адрес указывают в качестве первичного NS, а дополнительный адрес — в качестве вторичного NS.