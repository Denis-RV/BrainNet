# Окружение
*Need to know:*
- [[$ Base bash commands]] 
- [[1.3 Работа с командами#Создание своих команд с помощью alias]]

*status:* Ready
*format:* flow
*tegs:* #linux #programming 
*description:* На протяжении своей работы командная оболочка использует массу информации, которая и называется окружением. Данные, хранящиеся в окружении, используются программами для выяснения деталей конфигурации.

---
Программы использует для своей настройки не только конфигурационные файлы, но также и занчения из окружения.

### Команды:
```bash
$ printenv #выводит часть или все окружение
$ set #устанавливает параметры командной оболочки
$ export #экспортирует окружение для прогармм, 
#которые будут выполняться позднее

$ alias #создает псевдоним команды
```

**Командная оболочка хранит данные в окружении нескольких типов:**
1. ==Переменные командной оболочки== - фрагметы данных, инициализируемы командой bash.
2. ==Переменные окружения== - все остальное
3. ==Программируемые данные== (псевдонимы alias и функции командной оболочки).

## Исследование окружения
Используйте `set` или `printenv`, чтобы увидеть, что хранится в окружении. Команда `set` выводит переменные обоих видов (командной оболочки и окружений), а `printenv` выводит только переменные окружения.
```bash 
#для просмотра используйте | less
printenv | less 
>>>USER=me ...

printenv USER #эвкивалент echo $USER
>>>me
```

#### Некоторые важные переменные:
- DISPLAY - имя вашего дисплея
- EDITOR - текстовый редактор по умолчанию
- SHELL - программа командной оболочки
- HOME - путь к домашнему каталогу
- LANG - определяет набор символов и порядок сортировки для вашего языка
- OLD_PWD - предыдущий рабочий каталог
- PAGER - имя программы, дял постраничного текста
- PATH - список каталогов, в которых приозводится поиск испольняемых программ
- PS1 - строка приглашения к вводу №1 Определяет содержимое строки приглашения к вводу.
- PWD - текущий рабочий каталог
- TERM - тип терминала.
- TZ - часовой пояс 
- USER - имя пользователя.

## Оболочка входа и простая оболочка
Сеансы работы с консолью могут быть двух типов:
1. Login shell session - на входе запрашивает имя пользователя и пароль.
2. Non-login shell session (сеанс простой командной оболочки) - сеанс, котоый начинается при запуске тирминала в графическом окружении.

Командные оболочки читают один или несколько файлов запуска:

**Для Login shell session:**
- /etc/profile - общесистемный конфиг сценарий, настройка из которого применяются для всех пользователей.
- ~/.bash_profile - личный пользовательский фалй запуска. 
- ~/.bash_login - Bash читает этот файл, если есть файл ~/.bash_profile
- ~/.profile - bash читает этот файл, если нет двух предыдущих файлов.

**Для Non-login shell session:**
- /etc/bash.bashrc -  общесистемный конфиг сценарий, настройка из которого применяются для всех пользователей.
- ~/.bashrc - личный пользовательский фалй запуска. Очень вайжный файл.

Пример содержимого .bash_profile
```bash
# Загрузить псевдонимы и функции
if [ -f ~/.bashrc ]; then
	. ~/.bashrc
fi

# Определение пользовательского окружения и запуск программ
PATH=$PATH:$HOME/bin
export PATH
```

#### Дополнение и изменение переменных
Используя этот прием, можно добавлять текст в конец содержимого переменной:
```bash
foo="This is some"
echo $foo
>>>This is some
foo=$foo" text."
echo $foo
>>>This is some text.
```

#### Команда `export`
\- эта команда указывает командной оболочке сделать содержимое переменной PATH доступным дочерним процессам этой оболочки.

### Какие файлы следует изменять? 
PATH и дополнительнеые переменные окружения изменяем в файле .bash_profile (или .profile). В остальных случаях изменяем .bashrc. Если вам надо изменить личное окружения пользователя, изменяйте файлы в домашнем каталоге.

### Использование текстового редактора
Вы можете отредактировать любой документ из командной строкии с помощью любого текстового редактора, введя название редактора и документ.

==При редактировании конфигурационных файлай в целях безопасности необходимо создать его резервную копию. Выполните команду:==
```bash
cp config_file config_file.bak`
```
Для имен файлов с резервной копией часто используются расширения .bak, .sau, .old, .orig.

#### Текстовый редактор *nano*.
- `Ctrl+X` - выход из программы.
- `Ctrl+O` - сохранить файл и изменить имя.
- `Ctrl+S` - сохранить файл с текущим именем

### Активация изменения в окружении
Изменения, произведенные в файле .bashrc, не вступят в силу, пока вы не закроете терминал и не запустите новый, потому что оболочка читает содержимое файла .bashrc только в начале сеанса. Однако существует возможность принудить bash
повторно прочитать измененный файл .bashrc следующей командой:
```bash
source .bashrc
```

