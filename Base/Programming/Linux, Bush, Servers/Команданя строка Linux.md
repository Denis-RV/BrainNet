# Теория из книги

Created: Nov 23, 2020 4:57 PM
status: В процессе
format: flow
tags: #linux #programming 
need to know: -

---
## Исследование системы
#### Полезные сокращения варианты cd:
```bash
cd - #Сменить рабочий каталог на предыдущий
cd ~ #Сменить рабочий каталог на домашний. Если 
#пользователей несколько,можно добавить ~username.
```

#### Параметры и аргументы
Большинство праграмм имеют вид:
>command -params args

Пример команды с коротким и длинным параметром:
```bash
ls -lt --reverse
```

#### Описание длинного формата вывода команды ls:![[Pasted image 20210107011700.png]]

#### Определение типов файлов командой file
Линукс не показывает расширения файлов и сделать это можно лишь с помощью команды file file_name.

#### Чтение файлов
```bash
less file_name #программа просмотра файлов
cat file_name #вывод содержимого в консоль
nano #редактирование и прсомотр файла с помщоью Nano
vim #редактирование и прсомотр файла с помощью VIM
```
###### Команды программы less:![[Pasted image 20210107012950.png]]

##### Каталоги в системе Linux.
- / - корневой каталог
- /bin - двоичные программы для функционирования системы
- /boot - ядро Linux (/boot/vmlinuz)
- /dev - содержит узлы устройств
- /etc - системные конфигурационные файлы
	- /etc/crontab - расписание cron
	- /etc/fstab - таблица устройств хранения и соответствующих точек монтирования
	- /etc/passwd - список учетных записей
- /home - домашний каталог. Простые пользователи могут создавать файлы.
- /lib - содержит файлы разделяемых библиотек
- /lost+found - используется на случай частичного восстановления вопреждений в файловой системе. Если с системой все норм, каталог пустой.
- /media содержит точки монтирования съемных носителей. (/mnt в старых системах)
- /opt - для установки необяхательного программного обеспечения. 
- /proc - Виртуальная файловая система с файлами - глазками, через которые можно заглянуть в ядро.
- /root - домашний каталог
- /sbin - системные двоичные файлы. Жизнено важные программы.
- /tmp - временное хранилище для временных файлов. При перезагрузки может очищаться.
- /usr - содержит программы и файлы поддержки, используемые пользователями.
	- /usr/bin - испольняемы программы.
	- /usr/lib - библиотеки
	- /usr/local - исп. для установки программ, котоыре не входят в состав дистрибутива, но должны быть доступны.
	- /usr/sbin - доп. программы для администрирования
	- /usr/share - разделяемы данные, используемы программами в /usr/bin, в том числе конфиг файлы, ярлыки, фоновые изображения, звуковые файлы...
	- /usr/share/doc - документация пакетов, установленных в системе.
- /var - хранит часто изменяемые данные различных бд, буферные файлы, почту...
	- /var/log содержит файлы журналов с записями о различных действиях, выполнявшихся в системе.

---
## Операции с файлами и каталогами
#### Основные комманды
```bash
cp -a #скопировать файлы и каталоги со всеми 
#атрибутами и правами
cp -i #запрашивать подтверждение
cp -r #для копирования каталогов
cp -u #копировать файлы, отсутсвующие в каталоге 
#назначения или более новые
cp -v #подробный вывод информации в консоль

mv -i #аналогично cp
mv -uv #как cp -u и cp-v
mv ... dir #перемещает несколько файлов в dir

rm -irv
rm -f #Игнорировать отсутсвующие файлы.

ln file_name link_name #жесткая ссылка
ln -s file/dir_name link_name #символическая ссылка
```
Подробнее: [[Base params]].

#### Групповые символы
(использовать с командами, принимающими имена файлов в виде аргументов):
```bash
* #Любая последовательность любых символов
? #Любой один символ
[символы] #любой один символ из указанного множества символов
[!символы] #любой один символ, не принадлежащий указанным символам

#Классы символов, испо с командами, принимающие имена файлов:
[[:класс:]] #любой один символ, принадлежащий указанному классу
[:alnum:] #Любой алфавитно-цифровой символ
[:alpha:] #Любой цифровой символ
[:digit:] #Любая буква в нижнем регистре
[:upper:] #Любая буква в верхнем регистре

#Примеры:
[[:upper:]]* #Все имена файлов с буквы в верхнем регистре
[![:digit:]]* #Все имена файлов, не начинающиеся с цифры
*[[:lower]123] #Ф.заканчивающиеся буквой в нижнем регистер/цифрой123
```

#### Ссылки
==Жесткая ссылка:==
- не может указатывать на файл за пределами собственной файловой системы (в другом разделе диска)
- не может указывать на каталог
- неотличимы от исходного файла 
- Если удалить исходный файл, то жесткая ссылка его заменит

	У жетских ссылок для одного файла совпадает индексный узел, который можно посмотреить, введя комануд ls -li

==Символическая ссылка:==
- избавлена от ограницений жестих ссылок
- обычный указатель на файл или каталог.
- Могут быть битыми. При удалении исходного файла ссылка введет в никуда.
Пример символьной ссылки:
```bash
lrwxrwxrwx 1 root root 11 2012-08-11 07:34 libc.so.6 -> libc-2.6.so
```
---

## Работа с командами
**Вспомогательные команды:**
```bash
type #сообщает, как интерпретируется имя указанной команды.
which #определение местоположения исполняемой команды.
help #получение справки для встроенных команд (не иснтрукции)
man #выводит страницу справочного руководства с описанием команды
apropos #выводит список подходящих команд
info #выводит запись из справочного руководства info с описанием к.
whatis #выводит краткое описание команды
alias #создает псевдоним для команды
```

#### Типы команд:
- Выполняемая команда - скомпилированные двоичные программ, сценарии и др.
- Встроенная комнанда (shell builtins, builtin commands) - команды в оболочке bash (cd)
- Функции командной оболочки (shell functions) - сценарии на языке bash, встроенные в окружение.
- Псевдоним (alias) - команда, которую мы можем определить сами, сконструировав ее из других команд.

Чтобы определить тип команды, используем *type*.

#### Справка по коммандам.
Пример использования help:
```bash
help cd
>>>cd: cd [-L|-P] [dir]
```
##### Форма записи:
- квадратные скобки указывают на необязательность элемента.
- вертикальная черта исп. для перечисления взаимоисключающих вариантов.

`Исполняемы программы поддерживают параметр --help для вывода описания синтаксиса и параметров.`

##### Разделы правочного руководства man:
1. Пользовательские команды
2. Программные интерфесы системных вызовов в ядре
3. Программные интерфейсы в библеотеке C
4. Специальные файлы, такие как узлы устройств и драйверы
5. Форматы файлов
6. Игры и развлечения, такие как узлы устройств и драйверы
7. Прочее
8. Комнады системного администратирования.

Команда ==apropos== выводит близкие термины и их справочные руководства. Первое поле в каждой строке вывода — это имя страницы справочного руководства, а второе поле — номер раздела. Команда man с параметром -k действует как apropos .

##### Команда info - альлтернатива man![[Pasted image 20210109052116.png]]

`Пакет gzip включает специальную
версию less с именем zless`

#### Создание своих команд с помощью alias
Командная оболочка позволяет использовать сразу несколько комнад, разделяя их точкой с запятой: команда1; команда2; команда3... Пример: cd /usr; ls; cd -

>Чтобы создать свою команду, объединив другие, нужно придумать имя, но прежде проверить его с помощью $ type. Удалить псевдоним можно с помощью unalias.
```bash
$ type foo
#alias name='command1; command2; command3...'
$ alias foo='cd /usr; ls; cd-'
$ foo

#удаляем псевдоним foo
$ unalias foo
$ type foo
>>>file not found.
```
> Для просмотра всех существующих псевдонимов введите alias без аргументов. После завершения сеанса псевдонимы исчезают, но можно добавить определения псевдонима в файлы, чтобы они восстанавливались при каждом запуске.

---

## Перенаправление ввода/вывода
Команды:
```bash
$ cat #объединяет файлы
$ sort #сортирует строки текста
$ uniq #сообщает о повторяющихся строках или удаляет их
$ wc #выводит число символов перевода строки, слов и байтов в 
#каждом указанном файле
$ grep #находит и выводит строки, соответсвующие шаблону
$ head #выводит первые строки из файл
$ tail #выводит последние строки из файла
$ tee #читает данные со стандартного ввода и записывает в 
#стандартный вывод и в файлы
```

#### Перенаправления стандартного вывода (ошибок)
Вывод делиться на два типа: 1)результаты работы программы, 2)сообщения о состоянии или об ошибках. Команды выводят свои результаты в специальные файлы (standard output, stdout - 1 тип, standard error, stderr - второй тип), но по умолчанию многие выводы команд связаны с экраном и не сохранаяются на диске. Также многие программы принимают ввод из специального файла standard input, stdin, который по умолчанию связан с клавиатурой.

`Чтобы перенаправить стандартный вывод в другой файл вместо экрана, нужно добавить в команду оператор перенаправления > и имя файла.ВАЖНО: при перенаправлении вывода с помощью оператора > файл назначения всегда перезаписывается с самого начала. Чтобы не перезаписывать файл, а добавить информацию в конец, необходимо использовать >>`

Пример перенаправления вывода:
```bash
$ ls -l /usr/bin > ls-output.txt

$ > ls-out.txt #создаст новый файл или очисстит старый
$ ls -l /usr/bin >> ls-output.txt #добавит вывод в конец файла

```

Чтобы перенаправить стандартный вывод ошибок, нужно указать его дескрпитор файла (0-ввод, 1-вывод, 2-вывод ошибок):
```bash
$ ls -l /bin/usr 2> ls-error.txt
```

Перенаправление стандартного вывода и стандартного
вывода ошибок в один файл осуществляется 2 способами:
```bash
#First way. Необходимо сначала перенаправлять стандартный вывод.
$ ls -l /bin/usr > ls-output.txt 2>&1

#Second way. 
$ ls -l /bin/usr &> ls-output.txt # перезапись файла
$ ls -l /bin/usr &>> ls-output.txt # вывод в конец файла
```

##### /dev/null
- это файл представляет системное устройтсво под названием битоприемник (bit bucket), или мусорная корзина, которая принимает любой ввод и ничего с ним не делает. Перенаправляйте сюда файлы, чтобы подавить вывод сообщений об ошибках.

#### Перенаправление стандартного ввода
Команда cat читает содержимое одного или нескольких файлов и копирует его в стандартный вывод (без возможности пространичного просмотра).

С помощью команды ==cat== можно обхединять файлы:
```bash
# имеем файлы movie.mpeg.001, movie.mpeg.002 ... movie.mpeg.099
$ cat movie.mpeg.0* > movie.mpeg
```

Если ввести cat без аргументов, она будет выводить ввод в стандартный вывод. Это можно использовать для создания коротких текстовых файлов.
```bash
$ cat > record.txt
Any text
More text
Ctld + D
$ 
```
#### Конвейеры (оператор канала)
Оператор конвейера | (вертикальная черта), вывод одной команды можно связать с вводом другой: command1 | command2.
Например:
```bash
$ ls -l /usr/bin | less
```
С помощью этой команды можно ислодовать вывод любой команды, посылающей результаты на стандартный вывод.

#### Фильтры
Конвейеры позволяют объединить вместе несколько команд, и такие приемы называют ==фильтрами==. Фильтры принимают ввод, изменяют его определенным образом и выводят результат.

Например нам нужно составить список всех выполняемых программ в каталогах /bin и /usr/bin, расположив их по алфавиту:
```bash
$ ls /bin /usr/bin | sort | less
```

---
###  See also:
- [[Base commands]]
- [[Base params]]
