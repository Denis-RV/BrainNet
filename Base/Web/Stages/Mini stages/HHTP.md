# HyperText Transfer Protocol
*tegs:* #net #server #linux
*description:* 
*link:* https://ru.wikipedia.org/wiki/HTTP

---

## Знакомство c HTTP
Основой HTTP является технология «клиент-сервер», то есть предполагается существование:

- Потребителей (клиентов), которые инициируют соединение и посылают запрос;
- Поставщиков (серверов), которые ожидают соединения для получения запроса, производят необходимые действия и возвращают обратно сообщение с результатом.

HTTP используется также в качестве «транспорта» для других протоколов прикладного уровня, таких как [[$ SOAP]].

Основным объектом манипуляции в HTTP является ресурс, на который указывает [[$ URI]] в запросе клиента. Обычно такими ресурсами являются хранящиеся на сервере файлы, но ими могут быть логические объекты или что-то абстрактное.

### Программное обеспечение
Всё программное обеспечение для работы с протоколом HTTP разделяется на три большие категории:

- Серверы как основные поставщики услуг хранения и обработки информации (обработка запросов). Например: [[$ Nginx]], [[$ Apache HTTP Server]]
- Клиенты — конечные потребители услуг сервера (отправка запроса);
- Прокси (посредники) для выполнения транспортных служб.

## Структура HTTP-сообщения
Каждое HTTP-сообщение состоит из трёх частей, которые передаются в указанном порядке:
- Стартовая строка (англ. Starting line) — определяет тип сообщения;
- Заголовки (англ. Headers) — характеризуют тело сообщения, параметры передачи и прочие сведения;
- Тело сообщения (англ. Message Body) — непосредственно данные сообщения. Обязательно должно отделяться от заголовков пустой строкой.

Тело сообщения может отсутствовать, но стартовая строка и заголовок являются обязательными элементами.

*Для версии протокола 1.1 сообщение запроса обязательно должно содержать заголовок Host.*

### Стартовая строка
Стартовая строка
Стартовые строки различаются для запроса и ответа. Строка запроса выглядит так:

```
GET URI — для версии протокола 0.9;
Метод URI HTTP/Версия — для остальных версий.
```
Здесь:
- Метод (англ. Method) — тип запроса, одно слово заглавными буквами. В версии HTTP 0.9 использовался только метод GET, список методов для версии 1.1 представлен ниже.
- URI определяет путь к запрашиваемому документу.
- Версия (англ. Version) — пара разделённых точкой цифр. Например: 1.0.

Чтобы запросить страницу данной статьи, клиент должен передать строку (задан всего один заголовок):
```
GET /wiki/HTTP HTTP/1.0
Host: ru.wikipedia.org
```

==Стартовая строка ответа сервера== имеет следующий формат: `HTTP/Версия КодСостояния Пояснение`, где:
- Версия — пара разделённых точкой цифр, как в запросе;
- Код состояния (англ. Status Code) — три цифры. По коду состояния определяется дальнейшее содержимое сообщения и поведение клиента;
- Пояснение (англ. Reason Phrase) — текстовое короткое пояснение к коду ответа для пользователя. Никак не влияет на сообщение и является необязательным.
- 
Например, стартовая строка ответа сервера на предыдущий запрос может выглядеть так:
```
HTTP/1.0 200 OK
```

#### Методы
\- последовательность из любых символов, кроме управляющих и разделителей, указывающая на основную операцию над ресурсом. Обычно метод представляет собой короткое английское слово, записанное заглавными буквами. Обратите внимание, что название метода чувствительно к регистру.

Если сервер не распознал указанный клиентом метод, то он должен вернуть статус 501 (Not Implemented)

## Выполнение запросов

Для эмуляции http запросов можно воспользоваться утилитой ==telnet== (работают из консоли linux). Данная утилита позволяет подключиться к любому хосту, порту и посылать туда запросы.

Чтобы выполнить http запрос, от вас ожидают:
- GET URI - для версии протокола 0.9
- метод URI HTTP/Версия - для остальных версий.

Также следует указать Host: и домен.

Пример get-запроса к сайту httpbin.org:
```bash
>>>denis@LAPTOP-VOG3UST0:~$
<<<telnet httpbin.org 80
>>>Trying 34.231.30.52...
>>>Connected to httpbin.org.
>>>Escape character is '^]'.
<<<GET / HTTP/1.1
<<<Host: httpbin.org
<<<
>>>
	HTTP/1.1 200 OK
	Date: Mon, 22 Mar 2021 12:39:41 GMT
	Content-Type: text/html; charset=utf-8
	Content-Length: 9593
	Connection: keep-alive
	Server: gunicorn/19.9.0
	Access-Control-Allow-Origin: *
	Access-Control-Allow-Credentials: true
	
	<!DOCTYPE html>
	<html lang="en">

	<head>
	...
```

Пример put-запроса:
```bash
denis@LAPTOP-VOG3UST0:~$ 
<<<telnet httpbin.org 80
Trying 34.231.30.52...
Connected to httpbin.org.
Escape character is '^]'.
<<<
	POST /post HTTP/1.1
	Host: httpbin.org
	Connection: close
	Content-type: application/json
	Content-length: 14

	{"text":true}
```